# Backup and restore

For backup and restore procedures, refer to the documentation for each component:

- [Wazuh manager](https://github.com/wazuh/wazuh/blob/v5.0.0/docs/ref/backup-restore.md)
- [Wazuh agent](https://github.com/wazuh/wazuh-agent/blob/v5.0.0/docs/ref/backup-restore.md)

## Kubernetes-specific considerations

When backing up Wazuh deployments on Kubernetes, also consider:

### PersistentVolume backups

- Wazuh Manager and Indexer data are stored in PersistentVolumes.
- The indexer PersistentVolume contains the index data and indexer security state (including internal users).
- Use your storage provider's snapshot or backup capabilities:
  - **AWS EBS**: EBS snapshots via AWS Backup or manual snapshots
  - **GCP Persistent Disk**: Disk snapshots
  - **Azure Disk**: Disk snapshots
  - **On-premises**: Storage backend-specific backup tools
- Consider using Kubernetes backup tools like Velero for automated PV backups.

### Secrets and configuration

Back up the following Kubernetes Secrets containing credentials and certificates:

- `wazuh/secrets/wazuh-api-cred-secret.yaml` - Wazuh API credentials
- `wazuh/secrets/dashboard-cred-secret.yaml` - Dashboard credentials
- `wazuh/secrets/indexer-cred-secret.yaml` - Indexer credentials
- `wazuh/secrets/wazuh-authd-pass-secret.yaml` - Agent enrollment password
- `wazuh/secrets/wazuh-cluster-key-secret.yaml` - Cluster communication key
- Certificate secrets generated by the `wazuh-certs-tool.sh` script

Also back up any custom ConfigMaps you have created for configuration file persistence.

Store backups securely and encrypt them if they contain sensitive data.

### Manifest files

- Maintain version-controlled copies of all Kubernetes manifests, including customizations in `envs/`.
- This allows you to recreate the deployment configuration even if the cluster is lost.
